<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://arkdev.info/blog</id>
    <title>Ark Blog</title>
    <updated>2023-12-14T00:00:00.000Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://arkdev.info/blog"/>
    <subtitle>Ark Blog</subtitle>
    <icon>https://arkdev.info/img/ark-logo.png</icon>
    <entry>
        <title type="html"><![CDATA[Understanding Ark Liquidity Requirements]]></title>
        <id>https://arkdev.info/blog/liquidity-requirements</id>
        <link href="https://arkdev.info/blog/liquidity-requirements"/>
        <updated>2023-12-14T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Dive into the depths of Ark with our comprehensive guide on Liquidity Requirements. Explore how Ark liquidity intersect with money velocity]]></summary>
        <content type="html"><![CDATA[<p><img loading="lazy" alt="Bitcoin agora" src="/assets/images/ark-agora-3cd24eca68c6ea205fe05e02be046f15.png" width="896" height="512" class="img_ev3q"></p><p>This post discusses the liquidity requirements and calculates the funding needs of Ark Service Provider (ASP), as all transactions within Ark must be funded by the ASP.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-ark">What is Ark?<a href="#what-is-ark" class="hash-link" aria-label="Direct link to What is Ark?" title="Direct link to What is Ark?">​</a></h2><p>Ark is a promising second-layer solution for Bitcoin that could help improve the scalability and privacy of the network. It offers the following benefits:</p><ul><li><strong>No incoming liquidity required</strong>: Receivers can accept payments without having to worry about having enough funds in their wallets.</li><li><strong>Confidential payments</strong>: Ark protects the confidentiality of recipients, which is not always possible with other second-layer solutions.</li><li><strong>Scalable</strong>: Ark is a scalable solution that can help improve the scalability of Bitcoin.</li><li><strong>Secure</strong>: Ark is a secure solution that is built on top of the Bitcoin blockchain.</li></ul><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_S0QG"><p>It's recommended to read the <a href="/learn/nomenclature">nomenclature</a> first.</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="ark-liquidity-requirements">Ark liquidity requirements<a href="#ark-liquidity-requirements" class="hash-link" aria-label="Direct link to Ark liquidity requirements" title="Direct link to Ark liquidity requirements">​</a></h2><p>How much BTC can an ASP accept from new users without risking not having enough capital to fund transfers inside Ark? In other words, what percentage of BTC in Ark is transferred in a 1-month period?</p><p>This is similar to the definition of money velocity, as defined by the St. Louis Fed:</p><blockquote><p>The velocity of money is the frequency at which one unit of currency is used to purchase domestically-produced goods and services within a given time period.</p></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="money-velocity-mv">Money velocity (MV)<a href="#money-velocity-mv" class="hash-link" aria-label="Direct link to Money velocity (MV)" title="Direct link to Money velocity (MV)">​</a></h3><p>Here are some money velocity numbers:</p><ul><li>USD (Q3 2023): 1.327</li><li>Lightning (August 2023): 0.59 per month</li></ul><p>If we use a money velocity of 1.00 (for simplicity), this means that each BTC inside the Ark will be spent 1.00 of the time on a given period. Since the ASP must fund all transactions and onboarding, this means that for each 1 BTC added to the Ark, the ASP will need 1 BTC to fund the onboarding and 1 BTC to fund the transfers inside the Ark. With an initial balance of 100 BTC, this results in a limit of 50 BTC allowed to onboard (100 = 50 for onboarding + 50 for trades).</p><p>If MV = 0.59, this means that those initial 100 BTC would allow for 62.89 BTC of onboarding, where (100 = 62.89 for onboarding + (69.89 <!-- -->*<!-- --> 0.59 = 37.11) for trades).</p><p>In reality, the money velocity of Ark is likely to be somewhere between 1.00 and 0.59. This means that the ASP will need to have a certain amount of liquidity on hand to fund both onboarded BTC and transfers inside the Ark. The amount of liquidity required will depend on the specific money velocity of Ark, which is not yet known for sure.</p><p>Comparison table:</p><table><thead><tr><th align="right">Money velocity</th><th align="right">Balance</th><th align="right">+Onboard (BTC)</th><th align="right">Inside Ark (BTC)</th><th align="right">Transfers (BTC)</th></tr></thead><tbody><tr><td align="right">0.59</td><td align="right">100.00</td><td align="right">62.89</td><td align="right">0.00</td><td align="right">37.11</td></tr><tr><td align="right">1.00</td><td align="right">100.00</td><td align="right">50.00</td><td align="right">0.00</td><td align="right">50.00</td></tr><tr><td align="right">1.327</td><td align="right">100.00</td><td align="right">42.97</td><td align="right">0.00</td><td align="right">57.03</td></tr></tbody></table><p>After one month, all the funds used by the ASP, plus the funds sent by the users, become available again. This means that the ASP will have more available liquidity, so it can increase the allowed value for onboards. On the other hand, there is now more capital inside the Ark, so the ASP needs to reserve more capital to fund the transfers:</p><table><thead><tr><th align="right">Money velocity</th><th align="right">Balance</th><th align="right">+Onboard (BTC)</th><th align="right">Inside Ark (BTC)</th><th align="right">Transfers (BTC)</th></tr></thead><tbody><tr><td align="right">0.59</td><td align="right">162.89</td><td align="right">79.11</td><td align="right">62.89</td><td align="right">83.78</td></tr><tr><td align="right">1.00</td><td align="right">150</td><td align="right">50.00</td><td align="right">50.00</td><td align="right">100.00</td></tr><tr><td align="right">1.327</td><td align="right">142.97</td><td align="right">36.93</td><td align="right">42.97</td><td align="right">57.03</td></tr></tbody></table><p>Now, what would happen in a one-year period?</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>You can run your own simulations with the <a target="_blank" href="/liquidity-simulator/">Ark liquidity simulator</a>.</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="simulating-for-1-year">Simulating for 1 year<a href="#simulating-for-1-year" class="hash-link" aria-label="Direct link to Simulating for 1 year" title="Direct link to Simulating for 1 year">​</a></h3><p>Columns definition:</p><ul><li>Inside Ark = Accumulated of allowed onboards</li><li>ASP Balance = Initial balance + Inside Ark</li><li>Reserved for trades = Inside Ark <!-- -->*<!-- --> MV</li><li>Remaining = Balance - Reserved for trades</li><li>Allowed onboards = Remaining / (1 + MV)</li></ul><p>Money Velocity: 0.59</p><table><thead><tr><th align="right">Month</th><th align="center">Inside Ark</th><th align="center">ASP Balance</th><th align="center">Reserved for trades</th><th align="center">Remaining</th><th align="center">Allowed onboards</th></tr></thead><tbody><tr><td align="right">0</td><td align="center">0.00</td><td align="center">100.00</td><td align="center">0.00</td><td align="center">100.00</td><td align="center">0.00</td></tr><tr><td align="right">1</td><td align="center">0.00</td><td align="center">100.00</td><td align="center">0.00</td><td align="center">100.00</td><td align="center">62.89</td></tr><tr><td align="right">2</td><td align="center">62.89</td><td align="center">162.89</td><td align="center">37.11</td><td align="center">125.79</td><td align="center">79.11</td></tr><tr><td align="right">3</td><td align="center">142.00</td><td align="center">242.00</td><td align="center">83.78</td><td align="center">158.22</td><td align="center">99.51</td></tr><tr><td align="right">4</td><td align="center">241.51</td><td align="center">341.51</td><td align="center">142.49</td><td align="center">199.02</td><td align="center">125.17</td></tr><tr><td align="right">5</td><td align="center">366.68</td><td align="center">466.68</td><td align="center">216.34</td><td align="center">250.34</td><td align="center">157.45</td></tr><tr><td align="right">6</td><td align="center">524.13</td><td align="center">624.13</td><td align="center">309.24</td><td align="center">314.89</td><td align="center">198.05</td></tr><tr><td align="right">7</td><td align="center">722.18</td><td align="center">822.18</td><td align="center">426.09</td><td align="center">396.09</td><td align="center">249.12</td></tr><tr><td align="right">8</td><td align="center">971.29</td><td align="center">1,071.29</td><td align="center">573.06</td><td align="center">498.23</td><td align="center">313.35</td></tr><tr><td align="right">9</td><td align="center">1,284.65</td><td align="center">1,384.65</td><td align="center">757.94</td><td align="center">626.70</td><td align="center">394.15</td></tr><tr><td align="right">10</td><td align="center">1,678.80</td><td align="center">1,778.80</td><td align="center">990.49</td><td align="center">788.31</td><td align="center">495.79</td></tr><tr><td align="right">11</td><td align="center">2,174.59</td><td align="center">2,274.59</td><td align="center">1,283.01</td><td align="center">991.58</td><td align="center">623.64</td></tr><tr><td align="right">12</td><td align="center">2,798.23</td><td align="center">2,898.23</td><td align="center">1,650.95</td><td align="center">1,247.27</td><td align="center">784.45</td></tr></tbody></table><p>Money Velocity: 1</p><table><thead><tr><th align="right">Month</th><th align="center">Inside Ark</th><th align="center">ASP Balance</th><th align="center">Reserved for trades</th><th align="center">Remaining</th><th align="center">Allowed onboards</th></tr></thead><tbody><tr><td align="right">0</td><td align="center">0.00</td><td align="center">100.00</td><td align="center">0.00</td><td align="center">100.00</td><td align="center">0.00</td></tr><tr><td align="right">1</td><td align="center">0.00</td><td align="center">100.00</td><td align="center">0.00</td><td align="center">100.00</td><td align="center">50.00</td></tr><tr><td align="right">2</td><td align="center">50.00</td><td align="center">150.00</td><td align="center">50.00</td><td align="center">100.00</td><td align="center">50.00</td></tr><tr><td align="right">3</td><td align="center">100.00</td><td align="center">200.00</td><td align="center">100.00</td><td align="center">100.00</td><td align="center">50.00</td></tr><tr><td align="right">4</td><td align="center">150.00</td><td align="center">250.00</td><td align="center">150.00</td><td align="center">100.00</td><td align="center">50.00</td></tr><tr><td align="right">5</td><td align="center">200.00</td><td align="center">300.00</td><td align="center">200.00</td><td align="center">100.00</td><td align="center">50.00</td></tr><tr><td align="right">6</td><td align="center">250.00</td><td align="center">350.00</td><td align="center">250.00</td><td align="center">100.00</td><td align="center">50.00</td></tr><tr><td align="right">7</td><td align="center">300.00</td><td align="center">400.00</td><td align="center">300.00</td><td align="center">100.00</td><td align="center">50.00</td></tr><tr><td align="right">8</td><td align="center">350.00</td><td align="center">450.00</td><td align="center">350.00</td><td align="center">100.00</td><td align="center">50.00</td></tr><tr><td align="right">9</td><td align="center">400.00</td><td align="center">500.00</td><td align="center">400.00</td><td align="center">100.00</td><td align="center">50.00</td></tr><tr><td align="right">10</td><td align="center">450.00</td><td align="center">550.00</td><td align="center">450.00</td><td align="center">100.00</td><td align="center">50.00</td></tr><tr><td align="right">11</td><td align="center">500.00</td><td align="center">600.00</td><td align="center">500.00</td><td align="center">100.00</td><td align="center">50.00</td></tr><tr><td align="right">12</td><td align="center">550.00</td><td align="center">650.00</td><td align="center">550.00</td><td align="center">100.00</td><td align="center">50.00</td></tr></tbody></table><p>Money Velocity 1.327</p><table><thead><tr><th align="right">Month</th><th align="center">Inside Ark</th><th align="center">ASP Balance</th><th align="center">Reserved for trades</th><th align="center">Remaining</th><th align="center">Allowed onboards</th></tr></thead><tbody><tr><td align="right">0</td><td align="center">0.00</td><td align="center">100.00</td><td align="center">0.00</td><td align="center">100.00</td><td align="center">0.00</td></tr><tr><td align="right">1</td><td align="center">0.00</td><td align="center">100.00</td><td align="center">0.00</td><td align="center">100.00</td><td align="center">42.97</td></tr><tr><td align="right">2</td><td align="center">42.97</td><td align="center">142.97</td><td align="center">57.03</td><td align="center">85.95</td><td align="center">36.93</td></tr><tr><td align="right">3</td><td align="center">79.91</td><td align="center">179.91</td><td align="center">106.04</td><td align="center">73.87</td><td align="center">31.74</td></tr><tr><td align="right">4</td><td align="center">111.65</td><td align="center">211.65</td><td align="center">148.16</td><td align="center">63.49</td><td align="center">27.28</td></tr><tr><td align="right">5</td><td align="center">138.94</td><td align="center">238.94</td><td align="center">184.37</td><td align="center">54.57</td><td align="center">23.45</td></tr><tr><td align="right">6</td><td align="center">162.39</td><td align="center">262.39</td><td align="center">215.49</td><td align="center">46.90</td><td align="center">20.15</td></tr><tr><td align="right">7</td><td align="center">182.54</td><td align="center">282.54</td><td align="center">242.23</td><td align="center">40.31</td><td align="center">17.32</td></tr><tr><td align="right">8</td><td align="center">199.86</td><td align="center">299.86</td><td align="center">265.22</td><td align="center">34.64</td><td align="center">14.89</td></tr><tr><td align="right">9</td><td align="center">214.75</td><td align="center">314.75</td><td align="center">284.98</td><td align="center">29.78</td><td align="center">12.80</td></tr><tr><td align="right">10</td><td align="center">227.55</td><td align="center">327.55</td><td align="center">301.96</td><td align="center">25.59</td><td align="center">11.00</td></tr><tr><td align="right">11</td><td align="center">238.55</td><td align="center">338.55</td><td align="center">316.55</td><td align="center">22.00</td><td align="center">9.45</td></tr><tr><td align="right">12</td><td align="center">248.00</td><td align="center">348.00</td><td align="center">329.09</td><td align="center">18.90</td><td align="center">8.12</td></tr></tbody></table><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Results</div><div class="admonitionContent_S0QG"><p>Simulating the three different MV values over a one-year period, we can conclude the following:</p><ul><li>If MV &lt; 1, the ASP can onboard more BTC each month than in the previous month.</li><li>If MV = 1, the allowed value for onboarding BTC is always the same (half of the initial balance).</li><li>If MV &gt; 1, the value of allowed BTC to onboard converges to 0 over time, with the maximum onboard value equal to (initial balance) / (MV - 1).</li></ul></div></div><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>The money velocity (MV) for USD is quarterly. Assuming that M2 is constant and GDP is evenly distributed over the three months, the MV for one month should be ⅓ of the MV for the quarter, or 0.33.</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="algorithm">Algorithm<a href="#algorithm" class="hash-link" aria-label="Direct link to Algorithm" title="Direct link to Algorithm">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="allowed-onboard-value">Allowed onboard value<a href="#allowed-onboard-value" class="hash-link" aria-label="Direct link to Allowed onboard value" title="Direct link to Allowed onboard value">​</a></h4><p>The value of allowed onboard BTC for this round will be:</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Allowed onboard formula</div><div class="admonitionContent_S0QG"><p>(Available balance - User’s funds in Ark <!-- -->*<!-- --> MV) / (1 + MV)</p></div></div><p>Where:</p><ul><li>Available balance = Initial ASP balance + User’s funds</li><li>User’s funds = All BTC onboarded by users until now</li><li>MV = Money Velocity</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="money-velocity">Money velocity<a href="#money-velocity" class="hash-link" aria-label="Direct link to Money velocity" title="Direct link to Money velocity">​</a></h4><p>To calculate the value of Money Velocity:</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Money Velocity formula</div><div class="admonitionContent_S0QG"><p>Average for the last N rounds of (amount transferred / user’s funds)</p></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="rational">Rational<a href="#rational" class="hash-link" aria-label="Direct link to Rational" title="Direct link to Rational">​</a></h4><p>The ASP keeps records of onboarded and transferred amounts from previous rounds, and uses them to calculate the money velocity (MV) for the current round. It then uses the MV to calculate the maximum amount that can be onboarded in the current round.</p><p>If you've read this far, thank you! But now it's time for the bad news.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-utxo-model">The UTXO model<a href="#the-utxo-model" class="hash-link" aria-label="Direct link to The UTXO model" title="Direct link to The UTXO model">​</a></h2><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>How the UTXO Model Works</summary><div><div class="collapsibleContent_i85q"><p>In the UTXO model, each unit of cryptocurrency is treated as a unique and indivisible entity. When a user spends cryptocurrency, they are not actually spending their entire balance. Instead, they are spending specific UTXOs that they own.</p><p>Each UTXO has two important pieces of information:</p><ul><li>The amount of cryptocurrency: This is the value of the UTXO.</li><li>A locking script: This is a script that specifies how the UTXO can be spent. The locking script typically requires a digital signature from the owner of the UTXO.</li></ul><p>When a user wants to spend cryptocurrency, they create a new transaction. This transaction has two parts:</p><ul><li>Inputs: These are the UTXOs that the user is spending.</li><li>Outputs: These are the new UTXOs that will be created as a result of the transaction.</li></ul><p>The locking scripts of the input UTXOs must be satisfied in order for the transaction to be valid. This ensures that only the rightful owner of the cryptocurrency can spend it.</p></div></div></details><h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-change-problem">The change problem<a href="#the-change-problem" class="hash-link" aria-label="Direct link to The change problem" title="Direct link to The change problem">​</a></h3><p>But since Ark uses a UTXO model, this MV theory doesn't work, as the ASP will also need to fund the change on each transaction. For example, if Alice has a 1 BTC VTXO and wants to pay Bob 0.2 BTC, the ASP will need to fund two new VTXOs:</p><ul><li>0.2 BTC to Bob</li><li>0.8 BTC to Alice (change)</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="some-simulations">Some simulations<a href="#some-simulations" class="hash-link" aria-label="Direct link to Some simulations" title="Direct link to Some simulations">​</a></h4><p>Imagine that Alice boarded the Ark with 1 BTC. She has a 1 BTC VTXO and spends ⅓ of her money in the first month (MV = 0.33) using three payments of 0.11 BTC each.</p><p>Let's also assume that these payments are inside Ark (to Bob), which means that the ASP will also need to fund Bob's VTXO.</p><table><thead><tr><th align="center">Payment</th><th align="center">Value</th><th align="center">Alice VTXO</th><th align="center">Bob VTXOs<br>(0.11 each)</th><th align="center">Liquidity needed</th><th align="center">Liquidity accum</th></tr></thead><tbody><tr><td align="center">0</td><td align="center">0</td><td align="center">1.00</td><td align="center">0</td><td align="center">0</td><td align="center">0</td></tr><tr><td align="center">1</td><td align="center">0.11</td><td align="center">0.89</td><td align="center">1</td><td align="center">1.00</td><td align="center">1.00</td></tr><tr><td align="center">2</td><td align="center">0.11</td><td align="center">0.78</td><td align="center">2</td><td align="center">0.89</td><td align="center">1.89</td></tr><tr><td align="center">3</td><td align="center">0.11</td><td align="center">0.67</td><td align="center">3</td><td align="center">0.78</td><td align="center"><strong>2.67</strong></td></tr></tbody></table><p>At the end of the transaction, Alice has one VTXO of 0.67 BTC and Bob has three VTXOs of 0.11 BTC each.</p><div class="theme-admonition theme-admonition-danger alert alert--danger admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span><mdxadmonitiontitle>Huge funding needs (factor of <strong>8</strong>)</mdxadmonitiontitle></div><div class="admonitionContent_S0QG"><p>The ASP needed <strong>2.67</strong> of liquidity to support <strong>0.33</strong> traded inside Ark.</p></div></div><p>Things get much worse if the user makes 10 payments instead of 3 (spending 0.033 BTC on each):</p><table><thead><tr><th align="center">Payment</th><th align="center">Value</th><th align="center">Alice VTXO</th><th align="center">Bob VTXOs<br>(0.033 each)</th><th align="center">Liquidity needed</th><th align="center">Liquidity accum</th></tr></thead><tbody><tr><td align="center">0</td><td align="center">0</td><td align="center">1.00</td><td align="center">0</td><td align="center">0</td><td align="center">0</td></tr><tr><td align="center">1</td><td align="center">0.033</td><td align="center">0.97</td><td align="center">1</td><td align="center">1.00</td><td align="center">1.00</td></tr><tr><td align="center">2</td><td align="center">0.033</td><td align="center">0.93</td><td align="center">2</td><td align="center">0.97</td><td align="center">1.97</td></tr><tr><td align="center">3</td><td align="center">0.033</td><td align="center">0.90</td><td align="center">3</td><td align="center">0.93</td><td align="center">2.90</td></tr><tr><td align="center">4</td><td align="center">0.033</td><td align="center">0.87</td><td align="center">4</td><td align="center">0.90</td><td align="center">3.80</td></tr><tr><td align="center">5</td><td align="center">0.033</td><td align="center">0.84</td><td align="center">5</td><td align="center">0.87</td><td align="center">4.67</td></tr><tr><td align="center">6</td><td align="center">0.033</td><td align="center">0.80</td><td align="center">6</td><td align="center">0.84</td><td align="center">5.51</td></tr><tr><td align="center">7</td><td align="center">0.033</td><td align="center">0.77</td><td align="center">7</td><td align="center">0.80</td><td align="center">6.31</td></tr><tr><td align="center">8</td><td align="center">0.033</td><td align="center">0.74</td><td align="center">8</td><td align="center">0.77</td><td align="center">7.08</td></tr><tr><td align="center">9</td><td align="center">0.033</td><td align="center">0.70</td><td align="center">9</td><td align="center">0.74</td><td align="center">7.81</td></tr><tr><td align="center">10</td><td align="center">0.033</td><td align="center">0.67</td><td align="center">10</td><td align="center">0.70</td><td align="center"><strong>8.52</strong></td></tr></tbody></table><div class="theme-admonition theme-admonition-danger alert alert--danger admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span><mdxadmonitiontitle>Huge funding needs (factor of <strong>25</strong>)</mdxadmonitiontitle></div><div class="admonitionContent_S0QG"><p>The ASP needed <strong>8.52</strong> of liquidity to support <strong>0.33</strong> traded inside Ark.</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="possible-mitigations">Possible mitigations<a href="#possible-mitigations" class="hash-link" aria-label="Direct link to Possible mitigations" title="Direct link to Possible mitigations">​</a></h3><p>One can try to reduce these liquidity requirements by pushing several levers:</p><ul><li>Reduce MV by reducing the timelock (e.g., 2 weeks instead of 1 month).</li><li>Reduce transaction change by creating a set of UTXOs with a range of values on the first place, and then doing coin selection with the purpose of reducing change to the minimum possible.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="reduce-transaction-change">Reduce transaction change<a href="#reduce-transaction-change" class="hash-link" aria-label="Direct link to Reduce transaction change" title="Direct link to Reduce transaction change">​</a></h4><ul><li>Assuming MV = 0.33, and 10 payments of equal value during a month period</li><li>Dividing Alice’s initial UTXO into 10, 100, and 1000 VTXOs</li></ul><p>Using a 1:10 ratio for VTXOs:</p><table><thead><tr><th align="center">VTXO Value</th><th align="center">Payment<br>number</th><th align="center">Payment<br>value</th><th align="center">VTXOs used</th><th align="center">Alice balance</th><th align="center">Alice VTXOs</th><th align="center">Liquidity needed</th><th align="center">Liquidity accum</th></tr></thead><tbody><tr><td align="center">0.1</td><td align="center">0</td><td align="center">0.000</td><td align="center">0</td><td align="center">1.000</td><td align="center">10</td><td align="center">0.0</td><td align="center">0.00</td></tr><tr><td align="center">0.1</td><td align="center">1</td><td align="center">0.033</td><td align="center">1</td><td align="center">0.967</td><td align="center">10</td><td align="center">0.1</td><td align="center">0.10</td></tr><tr><td align="center">0.1</td><td align="center">2</td><td align="center">0.033</td><td align="center">1</td><td align="center">0.934</td><td align="center">10</td><td align="center">0.1</td><td align="center">0.20</td></tr><tr><td align="center">0.1</td><td align="center">3</td><td align="center">0.033</td><td align="center">1</td><td align="center">0.901</td><td align="center">10</td><td align="center">0.1</td><td align="center">0.30</td></tr><tr><td align="center">0.1</td><td align="center">4</td><td align="center">0.033</td><td align="center">1</td><td align="center">0.868</td><td align="center">10</td><td align="center">0.1</td><td align="center">0.40</td></tr><tr><td align="center">0.1</td><td align="center">5</td><td align="center">0.033</td><td align="center">1</td><td align="center">0.835</td><td align="center">10</td><td align="center">0.1</td><td align="center">0.50</td></tr><tr><td align="center">0.1</td><td align="center">6</td><td align="center">0.033</td><td align="center">1</td><td align="center">0.802</td><td align="center">10</td><td align="center">0.1</td><td align="center">0.60</td></tr><tr><td align="center">0.1</td><td align="center">7</td><td align="center">0.033</td><td align="center">1</td><td align="center">0.769</td><td align="center">10</td><td align="center">0.1</td><td align="center">0.70</td></tr><tr><td align="center">0.1</td><td align="center">8</td><td align="center">0.033</td><td align="center">1</td><td align="center">0.736</td><td align="center">10</td><td align="center">0.1</td><td align="center">0.80</td></tr><tr><td align="center">0.1</td><td align="center">9</td><td align="center">0.033</td><td align="center">1</td><td align="center">0.703</td><td align="center">10</td><td align="center">0.1</td><td align="center">0.90</td></tr><tr><td align="center">0.1</td><td align="center">10</td><td align="center">0.033</td><td align="center">1</td><td align="center">0.670</td><td align="center">10</td><td align="center">0.1</td><td align="center">1.00</td></tr></tbody></table><p>Using a 1:100 ratio for VTXOs:</p><table><thead><tr><th align="center">VTXO Value</th><th align="center">Payment<br>number</th><th align="center">Payment<br>value</th><th align="center">VTXOs used</th><th align="center">Alice balance</th><th align="center">Alice VTXOs</th><th align="center">Liquidity needed</th><th align="center">Liquidity accum</th></tr></thead><tbody><tr><td align="center">0.01</td><td align="center">0</td><td align="center">0.000</td><td align="center">0</td><td align="center">1.000</td><td align="center">100</td><td align="center">0.0</td><td align="center">0.00</td></tr><tr><td align="center">0.01</td><td align="center">1</td><td align="center">0.033</td><td align="center">4</td><td align="center">0.967</td><td align="center">97</td><td align="center">0.04</td><td align="center">0.04</td></tr><tr><td align="center">0.01</td><td align="center">2</td><td align="center">0.033</td><td align="center">4</td><td align="center">0.934</td><td align="center">94</td><td align="center">0.04</td><td align="center">0.08</td></tr><tr><td align="center">0.01</td><td align="center">3</td><td align="center">0.033</td><td align="center">4</td><td align="center">0.901</td><td align="center">91</td><td align="center">0.04</td><td align="center">0.12</td></tr><tr><td align="center">0.01</td><td align="center">4</td><td align="center">0.033</td><td align="center">4</td><td align="center">0.868</td><td align="center">88</td><td align="center">0.04</td><td align="center">0.16</td></tr><tr><td align="center">0.01</td><td align="center">5</td><td align="center">0.033</td><td align="center">4</td><td align="center">0.835</td><td align="center">85</td><td align="center">0.04</td><td align="center">0.20</td></tr><tr><td align="center">0.01</td><td align="center">6</td><td align="center">0.033</td><td align="center">4</td><td align="center">0.802</td><td align="center">82</td><td align="center">0.04</td><td align="center">0.24</td></tr><tr><td align="center">0.01</td><td align="center">7</td><td align="center">0.033</td><td align="center">4</td><td align="center">0.769</td><td align="center">79</td><td align="center">0.04</td><td align="center">0.28</td></tr><tr><td align="center">0.01</td><td align="center">8</td><td align="center">0.033</td><td align="center">4</td><td align="center">0.736</td><td align="center">76</td><td align="center">0.04</td><td align="center">0.32</td></tr><tr><td align="center">0.01</td><td align="center">9</td><td align="center">0.033</td><td align="center">4</td><td align="center">0.703</td><td align="center">73</td><td align="center">0.04</td><td align="center">0.36</td></tr><tr><td align="center">0.01</td><td align="center">10</td><td align="center">0.033</td><td align="center">4</td><td align="center">0.670</td><td align="center">70</td><td align="center">0.04</td><td align="center">0.40</td></tr></tbody></table><p>Using a 1:1000 ratio for VTXOs:</p><table><thead><tr><th align="center">VTXO Value</th><th align="center">Payment<br>number</th><th align="center">Payment<br>value</th><th align="center">VTXOs used</th><th align="center">Alice balance</th><th align="center">Alice VTXOs</th><th align="center">Liquidity needed</th><th align="center">Liquidity accum</th></tr></thead><tbody><tr><td align="center">0.001</td><td align="center">0</td><td align="center">0.000</td><td align="center">0</td><td align="center">1.000</td><td align="center">1000</td><td align="center">0.0</td><td align="center">0.00</td></tr><tr><td align="center">0.001</td><td align="center">1</td><td align="center">0.033</td><td align="center">33</td><td align="center">0.967</td><td align="center">968</td><td align="center">0.033</td><td align="center">0.03</td></tr><tr><td align="center">0.001</td><td align="center">2</td><td align="center">0.033</td><td align="center">33</td><td align="center">0.934</td><td align="center">936</td><td align="center">0.033</td><td align="center">0.07</td></tr><tr><td align="center">0.001</td><td align="center">3</td><td align="center">0.033</td><td align="center">33</td><td align="center">0.901</td><td align="center">904</td><td align="center">0.033</td><td align="center">0.10</td></tr><tr><td align="center">0.001</td><td align="center">4</td><td align="center">0.033</td><td align="center">33</td><td align="center">0.868</td><td align="center">872</td><td align="center">0.033</td><td align="center">0.13</td></tr><tr><td align="center">0.001</td><td align="center">5</td><td align="center">0.033</td><td align="center">33</td><td align="center">0.835</td><td align="center">840</td><td align="center">0.033</td><td align="center">0.17</td></tr><tr><td align="center">0.001</td><td align="center">6</td><td align="center">0.033</td><td align="center">33</td><td align="center">0.802</td><td align="center">808</td><td align="center">0.033</td><td align="center">0.20</td></tr><tr><td align="center">0.001</td><td align="center">7</td><td align="center">0.033</td><td align="center">33</td><td align="center">0.769</td><td align="center">776</td><td align="center">0.033</td><td align="center">0.23</td></tr><tr><td align="center">0.001</td><td align="center">8</td><td align="center">0.033</td><td align="center">33</td><td align="center">0.736</td><td align="center">744</td><td align="center">0.033</td><td align="center">0.26</td></tr><tr><td align="center">0.001</td><td align="center">9</td><td align="center">0.033</td><td align="center">33</td><td align="center">0.703</td><td align="center">712</td><td align="center">0.033</td><td align="center">0.30</td></tr><tr><td align="center">0.001</td><td align="center">10</td><td align="center">0.033</td><td align="center">33</td><td align="center">0.670</td><td align="center">680</td><td align="center">0.033</td><td align="center">0.33</td></tr></tbody></table><p>Comparison table:</p><table><thead><tr><th align="right">VTXO ratio</th><th align="right">MV</th><th align="right"># Payments</th><th align="right">ASP liquidity needed</th></tr></thead><tbody><tr><td align="right">10</td><td align="right">0.33</td><td align="right">10</td><td align="right">1.00</td></tr><tr><td align="right">100</td><td align="right">0.33</td><td align="right">10</td><td align="right">0.40</td></tr><tr><td align="right">1000</td><td align="right">0.33</td><td align="right">10</td><td align="right">0.33</td></tr></tbody></table><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>conclusion</div><div class="admonitionContent_S0QG"><p>Dividing the initial UTXO into more VTXOs decreases the need for funding.</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">​</a></h2><p>The liquidity requirements for an ASP will depend on three major factors:</p><ul><li><strong>Money velocity</strong>: This is not under the control of the ASP, and if it is higher than 1, the Ark capacity will converge to a fixed value.</li><li><strong>The locktime period on VTXOs</strong>: Reducing the locktime period will return the locked liquidity sooner. However, this also means that users will need to "recycle" their VTXOs sooner, which can be seen as a worse user experience.</li><li><strong>The VTXO ratio</strong>: In other words, this is the maximum allowed value for a given VTXO. At one extreme, the ASP could force all VTXOs to be of 1 sat, which would eliminate any "wasted" liquidity on change. However, this would also require millions of signatures from the user and ASP to construct a payment, which would cause a worse user experience.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="references">References<a href="#references" class="hash-link" aria-label="Direct link to References" title="Direct link to References">​</a></h2><ul><li><p>Velocity of M2 Money Stock
by St Louis Fed
<a href="https://fred.stlouisfed.org/series/M2V" target="_blank" rel="noopener noreferrer">https://fred.stlouisfed.org/series/M2V</a></p></li><li><p>Lightning Report
by River
<a href="https://river.com/learn/files/river-lightning-report-2023.pdf" target="_blank" rel="noopener noreferrer">https://river.com/learn/files/river-lightning-report-2023.pdf</a></p></li><li><p>Cryptocurrencies and the Velocity of Money
by Ingolf Gunnar Anton Pernice, Georg Gentzen, and Hermann Elendner
<a href="https://cryptoeconomicsystems.pubpub.org/pub/pernice-cryptocurrencies-velocity/release/9" target="_blank" rel="noopener noreferrer">https://cryptoeconomicsystems.pubpub.org/pub/pernice-cryptocurrencies-velocity/release/9</a></p></li></ul>]]></content>
        <author>
            <name>João Bordalo</name>
            <uri>https://github.com/bordalix</uri>
        </author>
        <category label="liquidity" term="liquidity"/>
        <category label="ark" term="ark"/>
        <category label="bitcoin" term="bitcoin"/>
    </entry>
</feed>